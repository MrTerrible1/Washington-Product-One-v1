Washington Event System — v0.1 Specification

This document defines the **canonical WashingtonEvent schema**, the full **v0.1 event dictionary**, and all emitter rules for Washington Product One.

It is a source-of-truth reference for:
- UI event wiring  
- VIA spine compatibility  
- N-BUS forwarding  
- Viewer analytics  
- Future VIA intelligence training  

Nothing in this file is optional.  
Nothing in this file should be changed without version approval.

---

# 1. Canonical Event Shape (Non-Negotiable)

Every event MUST follow this exact structure:

```ts
type WashingtonEvent = {
  type: string;            // uppercase event identifier
  sessionId: string;       // current session
  timestamp: string;       // ISO timestamp, generated at log time
  payload: object;         // event-specific data
};
Generated by:
useWashingtonEvents(source).logEvent(type, payload)

2. Event Types (v0.1)
Washington supports exactly five event types in v0.1:

Event Type	When Fired	Source Component
SESSION_START	App load / first mount	App.jsx
PAGE_VIEW	Route change (landing / viewer)	Landing + Viewer pages
CTA_CLICK	Any user-initiated action (button, card, toggle)	All components
PLAYER_EVENT	Play, pause, scrub, etc.	ViewerPage
ONBOARDING_EVENT	Step navigation, Skip, Start	OnboardingModal

These types are final for v0.1.

3. How to Emit Events
Use the event hook:

js
Copy code
const { logEvent, EVENT_TYPES } = useWashingtonEvents("component-name")
Example:

js
Copy code
logEvent(EVENT_TYPES.CTA_CLICK, {
  ctaName: "landing_video_click",
  videoId: item.id
})
The hook:

Adds sessionId

Adds timestamp

Merges your payload

Publishes to N-BUS if available

Logs to console always

4. Event Dictionary (Required Payloads)
Below is the complete event dictionary for v0.1, with required + optional fields.

4.1 SESSION_START
When fired:

As soon as App mounts (once per session)

Emitter:
App.jsx

Payload:

json
Copy code
{
  "source": "app-shell"
}
No additional payload fields allowed in v0.1.
SESSION_START must remain clean.

4.2 PAGE_VIEW
When fired:

Landing loads (/)

Viewer loads (/watch/:id)

Emitters:

VideoLandingPage.jsx

ViewerPage.jsx

Landing payload:
json
Copy code
{
  "source": "landing-page",
  "route": "landing"
}
Viewer payload:
json
Copy code
{
  "source": "viewer-page",
  "route": "viewer",
  "contentId": "<video-id>"
}
4.3 CTA_CLICK
When fired:
Any clickable UI element.

Emitters:

Landing video cards

VIA ribbon toggle

VIA panel button

Back button on viewer

Onboarding modal buttons

Future CTA elements

Rules:
ctaName is required.
Everything else is optional.

Examples:
Landing video click:
json
Copy code
{
  "source": "landing-page",
  "ctaName": "landing_video_click",
  "railId": "featured",
  "videoId": "wash-101",
  "title": "Welcome to Washington"
}
VIA panel opened:
json
Copy code
{
  "source": "via-ribbon",
  "ctaName": "via_investigate_open"
}
Back to landing:
json
Copy code
{
  "source": "viewer-page",
  "ctaName": "viewer_back_to_landing"
}
Onboarding “Next”:
json
Copy code
{
  "source": "onboarding-modal",
  "ctaName": "onboarding_next",
  "step": 1
}
4.4 PLAYER_EVENT
When fired:
Player interactions inside ViewerPage.

v0.1 supports:

"play"

"pause"

In future versions: "seek", "complete", "buffer_start", etc.

Example:
json
Copy code
{
  "source": "viewer-player",
  "eventName": "play",
  "videoId": "wash-101"
}
4.5 ONBOARDING_EVENT
When fired:
Any interaction inside onboarding modal.

Emitters:
OnboardingModal.jsx

Required payload fields:
step (1-3)

action (e.g., "next", "skip", "start")

Example:
json
Copy code
{
  "source": "onboarding-modal",
  "step": 2,
  "action": "next"
}
5. Event Publishing to N-BUS
Washington supports a pluggable event pipeline:

If window.NBUS.publishEvent exists → call it.

Otherwise → console log fallback.

This is implemented through:

scss
Copy code
publishEvent(event)
located in:

bash
Copy code
src/events/publishEvent.js
This ensures v0.1 is future-proof for v0.3 N-BUS rollout.

6. Event Emission Rules
6.1 MUST NOT
Mutate global state

Block UI

Throw

Execute async logic

Depend on external services

Modify the schema

6.2 MUST
Fire immediately

Use strict schema

Include correct source field

Include meaningful CTA names

Use camelCase for payload keys

7. Naming Conventions
ctaName
Required string identifier.
Format:

php-template
Copy code
<location>_<action>
Examples:

landing_video_click

via_investigate_open

onboarding_skip

viewer_back_to_landing

source
Always the name of the component file:

"app-shell"

"landing-page"

"viewer-page"

"viewer-player"

"via-ribbon"

"via-panel"

"onboarding-modal"

Keys inside payload
Must be:

camelCase

short

intuitive

8. Example Full Event
json
Copy code
{
  "type": "CTA_CLICK",
  "sessionId": "sess-02c5a819",
  "timestamp": "2025-11-14T23:52:00.214Z",
  "payload": {
    "source": "via-ribbon",
    "ctaName": "via_investigate_open",
    "contentId": "wash-101"
  }
}
9. Future Event Types (Documented for Planning Only)
Not implemented in v0.1 but intentionally reserved:

RECOMMENDATION_SHOWN

RECOMMENDATION_ACCEPTED

SESSION_CONTINUITY

DEVICE_PAIR

MENTOR_NEGOTIATION

CREATOR_ACTION

BRAND_ACTION

Do not emit these in v0.1.
